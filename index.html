<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OOêµíšŒ ì•ˆë‚´ ë° í™˜ì˜ í˜ì´ì§€</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        /* ------------------ CSS ìŠ¤íƒ€ì¼ ì‹œì‘ ------------------ */
        :root {
            --primary-color: #00796B; /* í¬ì¸íŠ¸ ìƒ‰ìƒ: ì²­ë¡ìƒ‰ */
            --secondary-color: #FFB300; /* ê°•ì¡° ìƒ‰ìƒ: ë…¸ë€ìƒ‰ */
            --background-light: #f9f9f9; /* ì—°í•œ ë°°ê²½ìƒ‰ */
            --text-dark: #333;
            --font-family: 'Noto Sans KR', sans-serif;
        }

        body {
            font-family: var(--font-family);
            margin: 0;
            padding: 0;
            background-color: white;
            color: var(--text-dark);
            line-height: 1.6;
            overflow-x: hidden;
            scroll-behavior: smooth;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        /* ------------------ í—¤ë” ìŠ¤íƒ€ì¼ ------------------ */
        header {
            background: linear-gradient(135deg, var(--primary-color) 0%, #004d40 100%);
            color: white;
            padding: 70px 20px;
            text-align: center;
        }

        header h1 {
            font-size: 3em;
            font-weight: 700;
            margin-bottom: 5px;
        }
        
        /* ğŸ’¡ ë¡œê³  ìŠ¤íƒ€ì¼ */
        .church-logo {
            width: 50px; 
            height: 50px;
            vertical-align: middle;
            margin-right: 15px;
            border-radius: 50%;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.2);
            background-color: white;
            padding: 5px;
        }
        
        .header-link {
            color: white;
            text-decoration: none;
            display: inline-block;
        }
        
        .main-verse {
            margin-top: 15px;
            font-style: italic;
            font-size: 1.1em;
            padding: 10px;
            background-color: rgba(255, 255, 255, 0.1);
            border-radius: 5px;
            display: inline-block;
        }

        /* ------------------ ê³µí†µ ì„¹ì…˜ ìŠ¤íƒ€ì¼ ------------------ */
        
        .section {
            padding: 60px 20px;
            border-bottom: 1px solid #eee;
        }

        .section-title {
            text-align: center;
            font-size: 2.2em;
            font-weight: 700;
            margin-bottom: 40px;
            color: var(--primary-color);
        }

        .new-visitor-guide {
            background-color: #e0f2f1;
            padding: 50px 20px;
            text-align: center;
            border-bottom: 5px solid var(--primary-color);
        }

        .new-visitor-guide h2 {
            color: var(--primary-color);
            font-size: 2.5em;
            font-weight: 700;
            margin-bottom: 15px;
        }

        .new-visitor-guide p {
            font-size: 1.1em;
            color: #555;
            margin-bottom: 30px;
        }

        .guide-box {
            display: flex;
            justify-content: center;
            gap: 20px;
            flex-wrap: wrap;
        }
        
        .guide-item {
            background-color: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            flex: 1 1 250px;
            max-width: 300px;
            border-top: 3px solid var(--secondary-color);
        }
        
        .guide-item i {
            color: var(--secondary-color);
            font-size: 2em;
            margin-bottom: 10px;
        }

        /* ì£¼ì†Œ/ì•ˆë‚´ ë¬¸êµ¬ ìŠ¤íƒ€ì¼ ë¶„ë¦¬ */
        .guide-item .address-text {
            font-weight: 500;
            margin-bottom: 5px;
            color: var(--text-dark);
        }
        .guide-item .guide-text {
            font-size: 0.95em;
            color: #777;
            margin-top: 5px;
        }

        .guide-button {
            display: inline-block;
            background-color: #D32F2F;
            color: white;
            padding: 12px 25px;
            text-decoration: none;
            border-radius: 5px;
            font-size: 1.1em;
            font-weight: 500;
            margin-top: 20px;
            transition: background-color 0.3s;
        }
        
        .guide-button:hover {
            background-color: #9a1a1a;
        }
        
        /* ë¹„ì „ ì„¹ì…˜ ìŠ¤íƒ€ì¼ */
        .vision-container {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            justify-content: center;
            text-align: center;
        }

        .vision-box {
            flex: 1 1 280px;
            padding: 25px;
            border: 2px solid var(--primary-color);
            border-radius: 10px;
            transition: all 0.3s;
        }
        
        .vision-box:hover {
            background-color: var(--background-light);
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0, 121, 107, 0.1);
        }

        .vision-box i {
            font-size: 3em;
            color: var(--secondary-color);
            margin-bottom: 15px;
        }
        
        .vision-box h3 {
            color: var(--primary-color);
            margin-top: 10px;
        }
        
        /* ì˜ˆë°° ì‹œê°„í‘œ ìŠ¤íƒ€ì¼ */
        .service-time {
            display: flex;
            flex-wrap: wrap;
            justify-content: space-around;
            text-align: center;
        }

        .time-box {
            background-color: var(--background-light);
            padding: 30px;
            margin: 10px;
            border-radius: 8px;
            flex: 1 1 300px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.08);
            border-top: 4px solid var(--primary-color);
        }

        .time-box .time {
            font-size: 2.5em;
            font-weight: 700;
            color: var(--text-dark);
            margin: 5px 0 10px 0;
        }
        
        /* ê³µì§€ì‚¬í•­ ìŠ¤íƒ€ì¼ */
        .notice-list {
            list-style: none;
            padding: 0;
            max-width: 800px;
            margin: 0 auto;
        }
        
        .notice-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background-color: white;
            border: 1px solid #ddd;
            border-left: 5px solid var(--secondary-color);
            border-radius: 8px;
            padding: 15px 20px;
            margin-bottom: 15px;
            transition: transform 0.2s, box-shadow 0.2s;
        }
        
        /* ------------------ ëª¨ë°”ì¼ ë°˜ì‘í˜• ì„¤ì • ------------------ */
        @media (max-width: 768px) {
            header h1 {
                font-size: 2.2em;
            }
            .church-logo {
                width: 40px; 
                height: 40px;
                margin-right: 10px;
            }
            .new-visitor-guide h2 {
                font-size: 2em;
            }
            .guide-box {
                flex-direction: column;
            }
            .guide-item {
                max-width: 100%;
            }
            .service-time {
                flex-direction: column;
            }
            .time-box {
                flex: 1 1 100%;
                margin: 10px 0;
            }
            .vision-container {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>

    <header>
        <div class="container">
            <a href="ì—°ê²°í• _ê°€ì •ì—°í•©_í™ˆí˜ì´ì§€_URL" target="_blank" class="header-link">
                <h1>
                    <img src="https://tse3.mm.bing.net/th/id/OIP.ktQjZetj97W-Yhv5feaSuwHaHa?pid=Api&h=220&P=0" alt="ê°€ì •ì—°í•© ë§ˆí¬" class="church-logo">
                    [OO êµíšŒ]
                </h1>
            </a>
            <p>í™˜ì˜í•©ë‹ˆë‹¤. ê°€ì •ì„ ì‚¬ë‘í•˜ëŠ”, êµ­ê°€ë¥¼ ì‚¬ë‘í•˜ëŠ” ê³µë™ì²´</p>
            <p class="main-verse">í†µì¼êµì¸ì€ ìê¸°ë¥¼ ìœ„í•´ì„œ ì‚¬ëŠ” ì‚¬ëŒì´ ì•„ë‹ˆë¼ ë‚¨ë“¤ì„ ìœ„í•´ì„œ ì‚¬ëŠ” ì‚¬ëŒì´ë‹¤. (85-36)</p>
        </div>
    </header>

    <section id="welcome-new" class="new-visitor-guide">
        <div class="container">
            <h2><i class="fas fa-handshake"></i> ìƒˆë¡œ ì˜¤ì‹  ë¶„ì„ í™˜ì˜í•©ë‹ˆë‹¤!</h2>
            <p>ì²˜ìŒ ë°©ë¬¸í•˜ì…¨ë‹¤ë©´, ì•ˆë‚´ ë°ìŠ¤í¬ì— ì ì‹œ ë“¤ëŸ¬ì£¼ì‹œê±°ë‚˜ ì•„ë˜ ë°©ë²•ìœ¼ë¡œ ë“±ë¡í•´ ì£¼ì‹œë©´ ì—°ë½ë“œë¦¬ê² ìŠµë‹ˆë‹¤.</p>
            <div class="guide-box">
                <div class="guide-item">
                    <i class="fas fa-phone-alt"></i>
                    <h3>ì „í™”/ë¬¸ì ë¬¸ì˜</h3>
                    <p class="address-text">ê¶ê¸ˆí•œ ì ì´ ìˆê±°ë‚˜ ë„ì›€ì´ í•„ìš”í•˜ë©´ ì–¸ì œë“ ì§€ ì „í™”í•˜ì„¸ìš”.</p>
                    <a href="tel:02-1234-5678" class="guide-button"><i class="fas fa-phone"></i> ìƒˆì‹êµ¬ ë¬¸ì˜ (02-1234-5678)</a>
                </div>
                <div class="guide-item">
                    <i class="fas fa-map-marker-alt"></i>
                    <h3>êµíšŒ ì£¼ì†Œ ë° ì•ˆë‚´</h3> 
                    <p id="church-address-display" class="address-text">ì—¬ê¸°ì— ì£¼ì†Œê°€ í‘œì‹œë©ë‹ˆë‹¤.</p> 
                    <p id="on-site-guide-display" class="guide-text">ì—¬ê¸°ì— í˜„ì¥ ì•ˆë‚´ ë¬¸êµ¬ê°€ í‘œì‹œë©ë‹ˆë‹¤.</p> 
                </div>
            </div>
        </div>
    </section>
    <div class="container">
        
        <section id="vision" class="section">
            <h2 class="section-title">êµíšŒ ë¹„ì „ (VISION)</h2>
            <div class="vision-container">
                <div class="vision-box">
                    <i class="fas fa-hands-praying"></i> <h3>ì˜ˆë°°ê°€ ì‚´ì•„ìˆëŠ” ê³µë™ì²´</h3>
                    <p>í•˜ëŠ˜ë¶€ëª¨ë‹˜ì„ ê²½ì™¸í•˜ë©° ì§„ë¦¬ì™€ ì„±ë ¹ìœ¼ë¡œ ì˜ˆë°°í•˜ëŠ” ê¸°ì¨ì´ ë„˜ì¹˜ëŠ” êµíšŒ</p>
                </div>
                <div class="vision-box">
                    <i class="fas fa-user-friends"></i>
                    <h3>ì‚¬ë‘ìœ¼ë¡œ ì„¬ê¸°ëŠ” ê³µë™ì²´</h3>
                    <p>ì„œë¡œë¥¼ ê¹Šì´ ì‚¬ë‘í•˜ë©° ì§€ì—­ ì‚¬íšŒì™€ ì´ì›ƒì„ ì„¬ê¸°ëŠ” ë”°ëœ»í•œ êµíšŒ</p>
                </div>
                <div class="vision-box">
                    <i class="fas fa-lightbulb"></i>
                    <h3>ë§ì”€ìœ¼ë¡œ ì„±ì¥í•˜ëŠ” ê³µë™ì²´</h3>
                    <p>ë§ì”€ì„ ë°°ìš°ê³  ì‹¤ì²œí•˜ë©° ë¯¿ìŒ ì•ˆì—ì„œ ì„±ìˆ™í•´ì ¸ ê°€ëŠ” ìë…€ë“¤ì˜ êµíšŒ</p>
                </div>
            </div>
        </section>
        
        <section id="service" class="section" style="background-color: var(--background-light);">
            <h2 class="section-title">ì£¼ì¼ ì˜ˆë°° ì‹œê°„ ì•ˆë‚´ <i class="far fa-clock"></i></h2>
            <div class="service-time">
                <div class="time-box">
                    <h3>1ë¶€ ì˜ˆë°° (ê²½ê±´)</h3>
                    <div class="time">ì˜¤ì „ 8:00</div>
                    <p>ë³¸ë‹¹ / ì„¤êµ: ë‹´ì„ ëª©ì‚¬</p>
                </div>
                <div class="time-box">
                    <h3>2ë¶€ ì˜ˆë°° (ê³µë™ì²´)</h3>
                    <div class="time">ì˜¤ì „ 10:30</div>
                    <p>ë³¸ë‹¹ / ì„¤êµ: ë‹´ì„ ëª©ì‚¬</p>
                </div>
                <div class="time-box">
                    <h3>ì²­ë…„ ì˜ˆë°°</h3>
                    <div class="time">ì˜¤í›„ 2:00</div>
                    <p>ë¹„ì „ì„¼í„° 3ì¸µ / ì„¤êµ: ì²­ë…„ë¶€ ë‹´ë‹¹</p>
                </div>
            </div>
        </section>

        <section id="notice" class="section">
            <h2 class="section-title">ì´ë²ˆ ì£¼ ì£¼ìš” ê³µì§€ <i class="fas fa-bullhorn"></i></h2>
            <ul class="notice-list">
                <li class="notice-item">
                    <strong>12/11(ìˆ˜) íŠ¹ë³„ ìƒˆë²½ ê¸°ë„íšŒ ì‹œì‘</strong>
                    <span>ë§¤ì¼ ìƒˆë²½ 5ì‹œ 30ë¶„, 3ì¸µ ë¹„ì „ì„¼í„°</span>
                </li>
                <li class="notice-item">
                    <strong>ê²¨ìš¸ ìˆ˜ë ¨íšŒ ì°¸ê°€ ë“±ë¡ ë§ˆê° ì„ë°•!</strong>
                    <span>12ì›” 15ì¼(ì¼)ê¹Œì§€ ë“±ë¡, ë¡œë¹„ ë°ìŠ¤í¬ ë˜ëŠ” ì˜¨ë¼ì¸ ì ‘ìˆ˜</span>
                </li>
                <li class="notice-item">
                    <strong>ìƒˆ ì‹ ì í™˜ì˜íšŒ ë° êµìœ¡ ì•ˆë‚´</strong>
                    <span>ì˜¤ëŠ˜ ì˜¤í›„ 12ì‹œ, ì¹œêµì‹¤ì—ì„œ 5ì£¼ ê³¼ì • ì‹œì‘í•©ë‹ˆë‹¤.</span>
                </li>
            </ul>
        </section>

        </div>
    
    <script>
/* ------------------ êµ¬ê¸€ ìŠ¤í”„ë ˆë“œì‹œíŠ¸ ì—°ë™ ì½”ë“œ (ìµœì¢… ìˆ˜ì •ë¨) ì‹œì‘ ------------------ */

// ğŸ’¡ ì¤‘ìš”: ì•„ë˜ 'YOUR_SHEET_ID'ë¥¼ ìŠ¤í”„ë ˆë“œì‹œíŠ¸ URLì—ì„œ ë³µì‚¬í•˜ì—¬ êµì²´í•˜ì„¸ìš”.
// URL ì˜ˆì‹œ: https://docs.google.com/spreadsheets/d/YOUR_SHEET_ID/edit#gid=0
const SHEET_ID = '1ylkHFx89o9634eb3ghNyYpP8Dlwy2nQfqsy8TXupi_8'; // ì‹¤ì œ IDë¡œ êµì²´ í•„ìš”
const SHEET_URL = `https://docs.google.com/spreadsheets/d/${SHEET_ID}/gviz/tq?tqx=out:json&gid=0`;

async function fetchAndRenderData() {
    try {
        const response = await fetch(SHEET_URL);
        const text = await response.text();
        
        // JSON ì‘ë‹µì—ì„œ ë°ì´í„° ì¶”ì¶œ ë° íŒŒì‹±
        const jsonText = text.substring(text.indexOf('(') + 1, text.lastIndexOf(')'));
        const json = JSON.parse(jsonText);
        
        const data = json.table.rows[0].c;
        const headers = json.table.cols.map(col => col.label);
        
        const churchData = {};
        headers.forEach((header, index) => {
            churchData[header] = data[index] && data[index].v ? data[index].v : ''; 
        });

        // ----------------- ğŸ¯ HTML ìš”ì†Œì— ë°ì´í„° ë°˜ì˜ -----------------
        
        // 1. êµíšŒ ì´ë¦„ ë°˜ì˜
        document.querySelector('header h1').innerHTML = 
            `<img src="https://tse3.mm.bing.net/th/id/OIP.ktQjZetj97W-Yhv5feaSuwHaHa?pid=Api&h=220&P=0" alt="ê°€ì •ì—°í•© ë§ˆí¬" class="church-logo"> ${churchData.church_name}`;

        // 2. ì „í™”/ë¬¸ì ë¬¸ì˜ ë°˜ì˜
        document.querySelector('.guide-item a[href^="tel:"]').href = churchData.phone_link;
        document.querySelector('.guide-item a[href^="tel:"]').innerHTML = `<i class="fas fa-phone"></i> ìƒˆì‹êµ¬ ë¬¸ì˜ (${churchData.phone_num})`;
        
        // 3. êµíšŒ ì£¼ì†Œ ë° í˜„ì¥ ì•ˆë‚´ ë°˜ì˜
        document.querySelector('#church-address-display').textContent = churchData.church_address || 'ì£¼ì†Œ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤.';
        document.querySelector('#on-site-guide-display').textContent = churchData.on_site_guide || 'í˜„ì¥ ì•ˆë‚´ ë¬¸êµ¬ê°€ ì—†ìŠµë‹ˆë‹¤.';


        // 4. ì£¼ì¼ ì˜ˆë°° ì‹œê°„ ë°˜ì˜ (3ë¶€ ì˜ˆë°°ëŠ” ì„ íƒ ì‚¬í•­: worship_time_3ì´ ë¹„ì–´ìˆìœ¼ë©´ ìˆ¨ê¹€)
        const worshipServices = [
            { dataKey: 'worship_time_1', title: '1ë¶€ ì˜ˆë°° (ê²½ê±´)', detailDefault: 'ë³¸ë‹¹ / ì„¤êµ: ë‹´ì„ ëª©ì‚¬' },
            { dataKey: 'worship_time_2', title: '2ë¶€ ì˜ˆë°° (ê³µë™ì²´)', detailDefault: 'ë³¸ë‹¹ / ì„¤êµ: ë‹´ì„ ëª©ì‚¬' },
            { dataKey: 'worship_time_3', title: 'ì²­ë…„ ì˜ˆë°°', detailDefault: 'ë¹„ì „ì„¼í„° 3ì¸µ / ì„¤êµ: ì²­ë…„ë¶€ ë‹´ë‹¹' }
        ];

        const timeBoxes = document.querySelectorAll('.service-time .time-box');
        
        timeBoxes.forEach((box, index) => {
            const service = worshipServices[index];
            const timeData = churchData[service.dataKey];
            
            if (timeData) {
                // ë°ì´í„°ê°€ ìˆìœ¼ë©´ í‘œì‹œ ë° ì—…ë°ì´íŠ¸
                box.style.display = 'block'; 
                
                const parts = timeData.split(' ');
                const timeText = parts[0] || ''; 
                const detailText = parts.slice(1).join(' ') || '';

                box.querySelector('h3').textContent = service.title;
                box.querySelector('.time').textContent = timeText;
                
                const sermonDetail = service.detailDefault.split('/ ì„¤êµ: ')[1];
                box.querySelector('p').textContent = detailText ? `${detailText} / ì„¤êµ: ${sermonDetail}` : service.detailDefault;
                
            } else {
                // ë°ì´í„°ê°€ ì—†ìœ¼ë©´ ìˆ¨ê¹€ ì²˜ë¦¬ (ì£¼ë¡œ 3ë¶€ ì˜ˆë°°ì— ì ìš©)
                if (index === 2) { // 3ë²ˆì§¸ time-boxë§Œ ìˆ¨ê¹€ ì²˜ë¦¬
                    box.style.display = 'none';
                }
            }
        });


        // 5. ì£¼ìš” ê³µì§€ ë°˜ì˜
        const noticeList = document.querySelector('.notice-list');
        noticeList.innerHTML = ''; 

        for (let i = 1; i <= 3; i++) {
            const titleKey = `notice_${i}`;
            const detailKey = `notice_detail_${i}`;

            if (churchData[titleKey] && churchData[detailKey]) {
                const li = document.createElement('li');
                li.className = 'notice-item';
                li.innerHTML = `
                    <strong>${churchData[titleKey]}</strong>
                    <span>${churchData[detailKey]}</span>
                `;
                noticeList.appendChild(li);
            }
        }


    } catch (error) {
        console.error("ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ ì˜¤ë¥˜ ë°œìƒ:", error);
    }
}

fetchAndRenderData();

/* ------------------ êµ¬ê¸€ ìŠ¤í”„ë ˆë“œì‹œíŠ¸ ì—°ë™ ì½”ë“œ (ìµœì¢… ìˆ˜ì •ë¨) ì¢…ë£Œ ------------------ */
    </script>

</body>
</html>